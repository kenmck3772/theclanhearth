const legendsData = [
    { 
        name: "The Brahan Seer", 
        title: "Coinneach Odhar, The Gaelic Nostradamus", 
        lore: `<h3>The Origins of the Seer</h3><p>Coinneach Odhar, whose name translates from Gaelic as "Dark Kenneth," is a figure shrouded in the mists of the 17th-century Highlands. While his exact origins are debated, the most common legend places his birth on the Isle of Lewis. The source of his prophetic gift is a tale in itself. The story goes that one day, while cutting peat with his mother, she saw the ghost of a Norse princess rise from a nearby grave. Fearing the apparition, she ran, but Coinneach was brave and stayed. The grateful spirit led him to a small, smooth stone with a hole in the center. She instructed him to look through the hole, and in doing so, he was granted the <em>dà-shealladh</em>, or "second sight."</p><p>This stone, often described as being blue or white with strange markings, became the source of his visions. By looking through it, he could see events far in the future, from local happenings to great national calamities.</p><h3>The Prophecies</h3><p>Coinneach's reputation grew as his prophecies, often delivered in cryptic, poetic Gaelic, came to pass with chilling accuracy. He worked as a labourer on the Brahan Estate, the seat of the powerful MacKenzie Earls of Seaforth, who became his patrons.</p><p>Some of his most famous prophecies include:</p><ul><li><strong>"The Day of the Great Sheep":</strong> He foretold that the glens of the Highlands would be emptied of their people and filled with sheep, a hauntingly accurate prediction of the Highland Clearances that would devastate the region a century after his death.</li><li><strong>"The Black Isle will be overrun by a black rain":</strong> This was interpreted as the coming of the railways, with their black engines and clouds of smoke.</li><li><strong>"A river will flow through the Great Glen":</strong> He foresaw the construction of the Caledonian Canal, which would connect the lochs of the Great Glen, creating a waterway from coast to coast.</li><li><strong>The Battle of Culloden:</strong> He is said to have seen the bloody defeat of the Highland army on Drummossie Moor, describing the field as being "stewed with the blood of the Gael."</li></ul><h3>The Doom of the Seaforths</h3><p>The Seer's most famous and fatal prophecy was the one that sealed his own fate. While his patron, Kenneth MacKenzie, the 3rd Earl of Seaforth, was on an extended trip to Paris, his wife, Countess Isabella, grew impatient and suspicious. She summoned Coinneach to Brahan Castle and demanded to know what her husband was doing.</p><p>At first, Coinneach was reluctant, telling her only that the Earl was well. But the Countess pressed him, threatening him if he did not reveal the full truth. Finally, he raised his seeing stone and described a scene of the Earl in a lavish Parisian room, on his knees before a beautiful French noblewoman, his arm around her waist.</p><p>Consumed by rage and humiliation, Countess Isabella refused to believe him. Accusing him of slandering her husband's name and practicing witchcraft, she ordered him to be seized and executed. According to legend, he was taken to Chanonry Point on the Black Isle and burned to death in a barrel of boiling tar.</p><p>Before he died, Coinneach uttered his final, terrible prophecy: the <strong>Doom of the Seaforths</strong>. He foretold that the direct line of the MacKenzie chiefs would end in tragedy. The last of the line would be a deaf-mute Earl who would have four sons, all of whom he would outlive. He also predicted that the Earl's wife would commit an unpardonable act and that the family's estates would be lost. Over the next 150 years, this prophecy came true in every detail, cementing the Brahan Seer's legend as Scotland's greatest prophet.</p>`, 
        recipes: [
            { name: "Seer's Brose with a Dram", link: "A simple, fortifying meal for a man of the people, made with the staples of the Highlands.", ingredients: ["1/2 cup pinhead or coarse oatmeal", "Pinch of salt", "1 tbsp butter (optional)", "1 tbsp honey or to taste", "Boiling water", "1 tbsp single malt whisky"], method: [ "Place the oatmeal and salt in a sturdy bowl.", "Add the butter, if using, and the honey.", "Pour over just enough boiling water to cover the oats. Stir vigorously...", "Cover the bowl with a plate and let it stand for 5-10 minutes...", "Stir in the whisky just before eating." ] },
            { name: "Black Isle Barley Water", link: "A restorative drink, reflecting the agricultural landscape of the Black Isle where the Seer met his end.", ingredients: ["1/2 cup pearl barley", "2 quarts water", "1 lemon, sliced", "1 cinnamon stick", "Honey to taste"], method: ["Rinse the barley well under cold water.", "In a large pot, combine the barley, water, lemon slices, and cinnamon stick.", "Bring to a boil, then reduce the heat and simmer for 30-40 minutes.", "Strain the liquid into a jug, discarding the solids.", "Sweeten with honey to your liking and serve warm or chilled."] }
        ]
    },
    { 
        name: "Rob Roy MacGregor", 
        title: "The Highland Rogue", 
        lore: `Robert "Rob Roy" MacGregor (1671–1734) is a figure who stands at the crossroads of history and legend. A cattleman, a Jacobite, and an outlaw, his life was a dramatic struggle against the powerful Duke of Montrose. After being branded an outlaw over a disputed debt, Rob Roy waged a private war against the Duke, becoming a master of cattle raiding and evading capture in the Trossachs. His exploits were later romanticized by Sir Walter Scott, transforming him from a complex historical figure into an enduring folk hero, a Scottish Robin Hood who embodied the spirit of resistance against oppression.`, 
        recipes: [
            { name: "Whisky-Glazed Stolen Beef", link: "A dish fit for an outlaw, using the finest beef 'liberated' from the Duke of Montrose's herds.", ingredients: ["2 lbs beef steak (sirloin or ribeye), thick-cut", "2 tbsp olive oil", "Salt and freshly ground black pepper", "For the glaze: 1/4 cup Scotch whisky, 2 tbsp brown sugar, 1 tbsp soy sauce, 1 clove garlic, minced"], method: [ "Rub the steaks with olive oil and season generously. Let them come to room temperature.", "Whisk together the glaze ingredients.", "Heat a heavy griddle pan or barbecue to a high heat.", "Sear the steaks for 3-4 minutes per side for medium-rare.", "In the last minute of cooking, brush the glaze generously over both sides of the steak...", "Remove the steaks from the heat and let them rest for 5-10 minutes before slicing." ] },
            { name: "Trossachs Mushroom and Wild Garlic Tart", link: "A forager's meal, using ingredients that could be gathered from the woods and glens where Rob Roy hid from the redcoats.", ingredients: ["1 sheet of puff pastry", "1 tbsp olive oil", "1 lb mixed wild mushrooms, sliced", "2 cloves garlic, minced", "A large handful of wild garlic leaves, chopped", "1/2 cup crème fraîche", "1/4 cup grated Gruyère cheese", "1 egg, beaten"], method: ["Preheat oven to 400°F (200°C).", "Unroll the pastry onto a baking sheet. Score a border about 1 inch from the edge.", "In a pan, heat the oil and cook the mushrooms until golden. Add the minced garlic and cook for another minute.", "Spread the crème fraîche inside the pastry border. Top with the cooked mushrooms and chopped wild garlic.", "Sprinkle with Gruyère cheese and brush the pastry border with the beaten egg.", "Bake for 15-20 minutes, until the pastry is puffed and golden."] }
        ] 
    },
    { 
        name: "The Marquess of Montrose", 
        title: "The Poet General", 
        lore: `James Graham, 1st Marquess of Montrose (1612-1650), was a figure of dazzling contradictions—a poet and a brilliant military tactician, a Covenanter who became the King's champion. During the Wars of the Three Kingdoms, he led a Royalist army on a remarkable 'year of miracles' in 1644-45, winning a series of stunning victories against superior Covenanter forces. His campaign, characterized by rapid movement and tactical genius, is considered one of the greatest feats in Scottish military history. Despite his ultimate defeat and execution, his daring and chivalry made him a romantic hero.`, 
        recipes: [
            { name: "Covenanter's Clapshot", link: "A humble but hearty dish for a soldier on a long march, combining the staple root vegetables of Scotland.", ingredients: ["2 lbs potatoes, peeled and chopped", "1 lb turnip (rutabaga), peeled and chopped", "4 tbsp butter", "Splash of milk or cream", "Salt and black pepper", "Chives, chopped, for garnish"], method: [ "Boil the potatoes and turnips in separate pots of salted water until very tender.", "Drain both vegetables thoroughly and return them to their pots over a low heat for a minute to drive off any excess steam.", "Combine the potatoes and turnips in one large bowl. Mash them together...", "Beat in the butter and enough milk or cream to achieve a creamy consistency.", "Season generously with salt and a good deal of black pepper.", "Stir in the chopped chives and serve hot..." ] },
            { name: "Montrose Spiced Plums", link: "A sophisticated dessert reflecting the Marquess's noble status, using fruits and spices that would have graced an aristocratic table.", ingredients: ["2 lbs plums, halved and stoned", "1 cup red wine", "1/2 cup brown sugar", "1 cinnamon stick", "3 cloves", "Zest of 1 orange"], method: ["Preheat oven to 350°F (175°C).", "Arrange the plum halves in a single layer in a baking dish.", "In a small saucepan, gently heat the red wine, sugar, cinnamon, cloves, and orange zest until the sugar has dissolved.", "Pour the spiced wine over the plums.", "Bake for 30-40 minutes, until the plums are soft and tender.", "Serve warm with cream or ice cream."] }
        ]
    },
    { 
        name: "Bonnie Prince Charlie", 
        title: "The Young Pretender", 
        lore: `<h3>The Young Pretender: A Prince's Gamble</h3><p>Charles Edward Stuart (1720-1788), known to history as <strong>Bonnie Prince Charlie</strong> and to his enemies as the "Young Pretender," is one of the most romantic and tragic figures in Scottish history. Born in exile in Rome, he was the grandson of the deposed King James VII of Scotland (James II of England) and the embodiment of the Jacobite hope to restore the Stuart dynasty to the British throne.</p><p>Raised on tales of his family's royal destiny, Charles was charismatic, handsome, and filled with a belief in his divine right to rule. In 1745, against the advice of his more cautious advisors, he launched an audacious gamble. With French backing having failed to materialize, he pawned his mother's jewels to fund two ships and set sail for Scotland, landing on the remote island of Eriskay in the Outer Hebrides with just seven companions.</p><h3>The 'Forty-Five': A Year of Miracles</h3><p>Initially, the Highland chiefs were appalled by his recklessness. Donald Cameron of Lochiel, one of the most powerful chiefs, advised him to return to France. But Charles's charm and his famous reply, "I am come home," stirred the deep-seated loyalty to the Stuart cause. Lochiel committed Clan Cameron, and with that crucial support, other clans like the MacDonalds of Clanranald soon followed.</p><p>What followed was a whirlwind campaign that stunned the British establishment. The Prince raised the Stuart standard at Glenfinnan, and his small Highland army swelled as it marched south. They captured Perth, then Edinburgh, and at the <strong>Battle of Prestonpans</strong>, they routed a larger, more experienced government army in a matter of minutes. This stunning victory made Charles the master of Scotland and fueled the belief that he could succeed.</p><p>He then led his army deep into England, reaching as far as <strong>Derby</strong>, just 125 miles from London. Panic gripped the capital. However, faced with a lack of English Jacobite support and the news of two large government armies marching against them, his commanders, most notably the brilliant Lord George Murray, advised a retreat. It was a controversial and heartbreaking decision for Charles, but one that likely saved his army from immediate annihilation.</p><h3>Culloden and the Flight through the Heather</h3><p>The retreat from England marked the beginning of the end. The exhausted and poorly supplied Jacobite army was finally cornered by a large government force led by the Duke of Cumberland on <strong>Drummossie Moor, near Culloden</strong>, on April 16, 1746. The battle was a brutal and decisive defeat. The Highland charge, so effective at Prestonpans, was broken by disciplined musket fire and artillery, and the battle was over in under an hour.</p><p>The aftermath was savage. Cumberland earned the name "Butcher" for the brutal suppression that followed, with government troops hunting down and killing fleeing Jacobites and devastating the Highlands.</p><p>With a massive bounty of £30,000 on his head, Bonnie Prince Charlie became a fugitive. For five months, he wandered the Highlands and Islands, a hunted man. His survival was entirely dependent on the unwavering loyalty of the Highlanders who risked everything to protect him. The most famous of these was <strong>Flora MacDonald</strong>, a young woman from the Isle of Skye who disguised the Prince as her Irish spinning maid, "Betty Burke," and smuggled him to safety. After numerous close escapes, he finally boarded a French ship in September 1746, never to set foot in Scotland again. He would spend the rest of his life in exile, a broken and disillusioned man, but his legend as the romantic, doomed prince would endure forever.</p>`, 
        recipes: [
            { name: "Drambuie and Raspberry Fool", link: "A dessert that tastes of romance and tragedy, using the iconic whisky liqueur said to have been gifted by the Prince himself.", ingredients: ["1 pint heavy (double) cream", "1 pint fresh raspberries", "3 tbsp Drambuie liqueur", "2 tbsp powdered sugar", "Toasted oatmeal or crushed shortbread for topping"], method: [ "Gently crush about three-quarters of the raspberries with a fork.", "Whip the heavy cream and powdered sugar until it forms soft peaks.", "Gently fold the Drambuie and the crushed raspberries into the whipped cream...", "Spoon the mixture into serving glasses, layering it with the remaining whole raspberries.", "Chill for at least an hour before serving.", "Top with a sprinkle of toasted oatmeal or crushed shortbread just before serving." ] },
            { name: "Cock-a-Leekie Soup", link: "A classic Scottish soup that would have been served at the grand banquets held in the Prince's honour at Holyrood Palace in Edinburgh.", ingredients: ["1 whole chicken (about 3 lbs)", "12 prunes, pitted", "8 large leeks, cleaned and sliced", "2 quarts chicken stock", "Salt and pepper", "Chopped fresh parsley"], method: ["Place the chicken in a large stockpot and cover with the chicken stock. Bring to a simmer and cook for 1.5 hours, or until the chicken is cooked through.", "Remove the chicken from the pot. When cool enough to handle, shred the meat from the bones and discard the skin and bones.", "Add the sliced leeks to the stock and simmer for 20 minutes until tender.", "Return the shredded chicken to the pot and add the pitted prunes.", "Simmer for a final 10 minutes. Season to taste with salt and pepper and serve hot, garnished with parsley."] }
        ]
    },
    { 
        name: "William Wallace", 
        title: "Guardian of Scotland", 
        lore: `Sir William Wallace (c. 1270–1305) is one of Scotland's most enduring national heroes. A knight of lesser nobility, he rose from obscurity to lead the Scottish resistance during the first Wars of Scottish Independence. His victory over the English at the Battle of Stirling Bridge in 1297 was a masterstroke of strategy and made him a legend. Appointed Guardian of Scotland, he was the de facto leader of the nation. Though later defeated at the Battle of Falkirk, he was never broken. Captured by the English, he was brutally executed in London, but his martyrdom inspired his countrymen, including Robert the Bruce, to continue the fight for freedom.`, 
        recipes: [
            { name: "Wallace's Bannock Bread", link: "The food of a guerrilla army. Bannocks are simple, unleavened flatbreads made from oatmeal or barley, cooked on a griddle (or a hot stone in a campfire). It was the staple food that could be made quickly and easily, fueling Wallace's army on the march.", ingredients: ["2 cups medium oatmeal", "1/2 tsp salt", "1 tsp baking soda", "2 tbsp melted butter or bacon fat", "Approx. 1 cup buttermilk or hot water"], method: [ "In a bowl, mix the oatmeal, salt, and baking soda.", "Stir in the melted butter or fat.", "Gradually add enough buttermilk or hot water to form a soft, but not sticky, dough.", "On a lightly floured surface, knead the dough briefly and roll it out into a round about 1/2 inch thick.", "Cut the round into four or six wedges (farls).", "Cook on a lightly greased, hot griddle or heavy frying pan for about 4-5 minutes per side, until golden and cooked through. Best served warm with butter." ] },
            { name: "Stirling Bridge Smoked Trout", link: "A simple dish representing the bounty of the rivers like the Forth, where Wallace won his greatest victory.", ingredients: ["2 whole smoked trout", "1 lemon, cut into wedges", "A handful of fresh dill", "Black pepper", "Oatcakes or rye bread to serve"], method: ["Carefully remove the skin from the smoked trout.", "Place the trout on a serving platter and flake the flesh slightly with a fork.", "Garnish generously with fresh dill sprigs and freshly ground black pepper.", "Serve immediately with lemon wedges for squeezing over the fish, and a side of traditional Scottish oatcakes or dark rye bread."] }
        ] 
    },
    { 
        name: "Robert the Bruce", 
        title: "The Warrior King", 
        lore: `Robert I (1274–1329), popularly known as Robert the Bruce, was the king who secured Scotland's independence from England. His early career was complex, marked by shifting allegiances, but after the execution of William Wallace, he seized the throne in 1306 and became the undisputed leader of the Scottish cause. He was a brilliant guerrilla tactician, leading a long and arduous campaign against the English. His perseverance culminated in the legendary and decisive victory at the Battle of Bannockburn in 1314, where his small Scottish army defeated a much larger English force. His reign established a new dynasty and ensured that Scotland would remain an independent kingdom for centuries to come.`, 
        recipes: [
            { name: "King Robert's Crown Roast of Lamb", link: "A dish fit for a king's celebration after a great victory. A crown roast is a spectacular centerpiece, symbolizing the crown that Bruce fought so hard to win and secure for Scotland.", ingredients: ["2 racks of lamb (8 ribs each), frenched", "For the stuffing: 1 cup breadcrumbs, 1/4 cup chopped dried apricots, 1/4 cup chopped nuts (pistachios or almonds), 2 tbsp chopped fresh mint, 1 small onion, finely chopped, 1 egg, beaten", "For the glaze: 2 tbsp honey, 1 tbsp Dijon mustard", "Salt and pepper"], method: [ "Preheat oven to 400°F (200°C).", "To make the stuffing, sauté the onion until soft, then mix with all other stuffing ingredients. Season well.", "Bend each rack of lamb into a semicircle and tie them together with kitchen twine to form a 'crown'. Place in a roasting tin.", "Fill the center of the crown with the stuffing mixture.", "Roast for 15 minutes, then reduce the oven temperature to 350°F (180°C).", "Mix the honey and mustard for the glaze and brush it over the lamb. Continue to roast for another 15-20 minutes for medium-rare.", "Let the roast rest for 10 minutes before carving between the ribs to serve." ] },
            { name: "Bannockburn Honey Cakes", link: "Small, sweet cakes made with honey and oats, representing the sweet taste of victory at Bannockburn.", ingredients: ["1 cup rolled oats", "1 cup all-purpose flour", "1/2 cup brown sugar", "1/2 tsp baking soda", "1/2 tsp ground ginger", "1/2 cup butter, melted", "1/4 cup honey", "1 egg, beaten"], method: ["Preheat oven to 350°F (175°C) and grease a baking sheet.", "In a bowl, combine the oats, flour, sugar, baking soda, and ginger.", "In a separate bowl, whisk together the melted butter, honey, and beaten egg.", "Pour the wet ingredients into the dry ingredients and mix until just combined.", "Drop spoonfuls of the mixture onto the prepared baking sheet, leaving space between them.", "Bake for 12-15 minutes, until golden and firm at the edges.", "Let cool on the baking sheet for a few minutes before transferring to a wire rack to cool completely."] }
        ]
    }
];
```
</document>

I have also updated the `js/main.js` file to correctly handle the new `recipes` array in the `legendsData`.


```javascript
document.addEventListener('DOMContentLoaded', function() {
    // --- INITIALIZATION ---
    initNav();
    initClansPage();
    setupDossierPage({
        sectionId: 'legends-section',
        mainContentId: 'legends-main-content',
        listData: [{ title: 'Legendary Figures', data: legendsData, type: 'figure', displayFn: displayFigure }]
    });
    initTartanBuilder(); 
    initRecipeBook();
    initMarketplace();
    initClanFinder();
    initTripPlanner();
    initTranslator();

    // --- NAVIGATION ---
    function initNav() {
        const navLinks = document.querySelectorAll('.nav-link');
        const pageSections = document.querySelectorAll('.page-section');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                const targetId = link.dataset.target + '-section';
                pageSections.forEach(section => section.classList.toggle('active', section.id === targetId));
                navLinks.forEach(nav => nav.classList.remove('active'));
                document.querySelectorAll(`.nav-link[data-target="${link.dataset.target}"]`).forEach(l => l.classList.add('active'));
                
                if (targetId === 'clans-section' && window.clanMap) {
                     setTimeout(() => {
                        window.clanMap.invalidateSize();
                    }, 50);
                }
                if (targetId === 'tartan-designer-section') {
                    setTimeout(() => {
                        window.dispatchEvent(new Event('resize'));
                    }, 50);
                }
                if (targetId === 'trip-planner-section' && window.tripPlannerMap) {
                     setTimeout(() => {
                        window.tripPlannerMap.invalidateSize();
                    }, 50);
                }
                mobileMenu.classList.add('hidden');
            });
        });
        
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        document.querySelector('.nav-link[data-target="home"]').classList.add('active');
        document.getElementById('home-section').classList.add('active');
    }

    function setupTabs(container) {
        const tabs = container.querySelectorAll('.tab-button');
        const tabContents = container.querySelectorAll('.tab-content');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                tabContents.forEach(content => content.classList.remove('active'));
                const contentEl = container.querySelector(`#${tab.dataset.tab}-content`);
                if (contentEl) contentEl.classList.add('active');
            });
        });
    }

    // --- GENERIC MODAL & MESSAGE BOX ---
    window.openGenericModal = function(item) {
        const modal = document.getElementById('generic-modal');
        const modalContent = document.getElementById('modal-content');
        
        let contentHTML = `
            <div class="p-6 md:p-8">
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold font-title mb-2 text-yellow-900">${item.name}</h2>
                    <button id="close-modal" class="text-3xl font-bold text-stone-500 hover:text-stone-800">&times;</button>
                </div>`;
        
        if (item.title) { // For Legends
             contentHTML += `<p class="text-md text-stone-600 mb-6 italic">${item.title}</p>`;
        } else if (item.gaelicName) { // For Clans
             contentHTML += `<p class="text-md text-stone-600 mb-6 italic">${item.gaelicName}</p>`;
        }
        if (item.link) { // For Recipes
             contentHTML += `<p class="text-md text-stone-600 mb-6 italic">"${item.link}"</p>`;
        }

        if(item.lore) { // For Clans and Legends
            contentHTML += `<div class="prose max-w-none text-stone-700 space-y-4 mb-8">${item.lore.replace(/\n\n/g, '</p><p>')}</div>`;
        }

        if(item.ingredients && item.method) { // For Recipes
            contentHTML += `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold border-b-2 border-yellow-700 pb-2 mb-3">Ingredients</h3>
                        <ul class="list-disc list-inside space-y-1 text-stone-700">${item.ingredients.map(i => `<li>${i}</li>`).join('')}</ul>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold border-b-2 border-yellow-700 pb-2 mb-3">Method</h3>
                        <ol class="list-decimal list-inside space-y-2 text-stone-700">${item.method.map(s => `<li>${s}</li>`).join('')}</ol>
                    </div>
                </div>`;
        } else if (item.recipes) { // For Legends with multiple recipes
             contentHTML += item.recipes.map(recipe => `
                <div class="mb-8">
                    <h3 class="text-2xl font-semibold text-stone-800 mb-2 font-title">${recipe.name}</h3>
                    <p class="mb-6 text-stone-600 italic">"${recipe.link}"</p>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1">
                            <h4 class="font-semibold text-stone-700 mb-3 border-b-2 border-yellow-700 pb-2">Ingredients</h4>
                            <ul class="list-disc list-inside space-y-2 text-stone-600">${recipe.ingredients.map(i => `<li>${i}</li>`).join('')}</ul>
                        </div>
                        <div class="lg:col-span-2">
                            <h4 class="font-semibold text-stone-700 mb-3 border-b-2 border-yellow-700 pb-2">Method</h4>
                            <ol class="list-decimal list-inside space-y-3 text-stone-600">${recipe.method.map(s => `<li>${s}</li>`).join('')}</ol>
                        </div>
                    </div>
                </div>
             `).join('<hr class="my-8">');
        }
        
        contentHTML += `</div>`;

        modalContent.innerHTML = contentHTML;
        modal.classList.remove('hidden');
        modal.classList.add('flex', 'animate-fade-in');
        
        modal.querySelector('#close-modal').addEventListener('click', () => {
            modal.classList.add('hidden');
            modal.classList.remove('flex', 'animate-fade-in');
        });
    }

    window.showMessage = function(text, isError = false) {
        const messageBox = document.getElementById('message-box');
        const messageText = document.getElementById('message-text');
        messageText.textContent = text;
        messageBox.className = 'fixed top-20 right-5 py-2 px-4 rounded-lg shadow-lg transition-all duration-300 z-50';
        messageBox.classList.add(isError ? 'bg-red-600' : 'bg-green-600', 'text-white', 'opacity-100');
        
        setTimeout(() => {
            messageBox.classList.remove('opacity-100');
            messageBox.classList.add('opacity-0');
        }, 3000);
    }
});
