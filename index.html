<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Clan Hearth — Trips v2 + Clan Drawer</title>
  <meta name="description" content="Plan day-by-day itineraries and explore clans with a rich detail drawer." />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/4ec4e4f1df.js" crossorigin="anonymous"></script>
  <!-- Optional: jsPDF for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-3f0PjzYpQf8u1f2P9VokxB4mL1gWc7FQm2qkK8QvE5FQFzZ3hQ0zJbW4gXWFS5x0HIfPw3+q9o8a+zJg9tQ7WQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body class="bg-stone-50 text-stone-900 dark:bg-neutral-950 dark:text-neutral-100">
  <header class="bg-neutral-900/80 text-neutral-100 sticky top-0 z-40 backdrop-blur border-b border-neutral-800">
    <div class="max-w-6xl mx-auto flex items-center justify-between p-3">
      <div class="flex items-center gap-3">
        <img src="assets/images/hearth-crest.png" alt="The Clan Hearth" width="40" height="40" onerror="this.style.display='none'">
        <div>
          <div class="font-bold leading-tight">The Clan Hearth</div>
          <div class="text-xs text-neutral-400">Trips v2 · Clan Drawer</div>
        </div>
      </div>
      <nav class="flex gap-2">
        <button class="nav-link pill" data-target="clans">Clans</button>
        <button class="nav-link pill" data-target="trip-builder">Trips</button>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4">
    <!-- CLANS with Map + Drawer -->
    <section id="clans-section" class="active">
      <div class="grid-2">
        <aside>
          <h3 class="font-semibold mb-2">Clans</h3>
          <div id="clan-sidebar-list"></div>
        </aside>
        <div>
          <div id="clanMap" class="mb-3 mapbox"></div>
          <div id="map-info" class="content-card p-4 rounded-xl border border-amber-200/60"></div>
        </div>
      </div>
    </section>

    <!-- Trip Builder v2 -->
    <section id="trip-builder-section">
      <div class="flex items-start gap-3 flex-wrap">
        <div class="grow min-w-[320px]">
          <div class="rounded-xl border p-3 bg-white/70 dark:bg-neutral-900">
            <div class="grid md:grid-cols-3 gap-3">
              <div>
                <label class="block text-sm mb-1">Trip type</label>
                <select id="trip-type" class="w-full border rounded p-2">
                  <option value="heritage">Heritage</option>
                  <option value="whisky">Whisky</option>
                  <option value="golf">Golf</option>
                  <option value="luxury">Luxury</option>
                </select>
              </div>
              <div>
                <label class="block text-sm mb-1">Days</label>
                <select id="trip-days" class="w-full border rounded p-2">
                  <option>3</option><option selected>5</option><option>7</option><option>10</option>
                </select>
              </div>
              <div>
                <label class="block text-sm mb-1">Group size</label>
                <select id="group-size" class="w-full border rounded p-2">
                  <option>2</option><option selected>4</option><option>6</option><option>8</option>
                </select>
              </div>
            </div>
            <div class="mt-3 flex gap-2">
              <button id="create-itinerary-btn" class="btn-primary rounded-lg px-4 py-2"><i class="fas fa-calendar-plus mr-1"></i>Create itinerary</button>
              <button id="export-pdf-btn" class="rounded-lg px-4 py-2 border"><i class="fas fa-file-pdf mr-1"></i>Export PDF</button>
              <button id="email-itinerary-btn" class="rounded-lg px-4 py-2 border"><i class="fas fa-envelope mr-1"></i>Email plan</button>
            </div>
            <div class="mt-2 text-sm">Price estimate: £<span id="price-estimate">0</span> • Total distance: <span id="total-distance">0</span> km • Total drive: <span id="total-drive">0</span> h</div>
          </div>

          <div id="itinerary" class="mt-3 grid md:grid-cols-2 gap-3"></div>
        </div>
        <div class="basis-[380px] grow">
          <div id="tripBuilderMap" class="mapbox mb-3"></div>
          <div class="content-card p-3 rounded-xl border">
            <h4 class="font-semibold mb-2">Add from suggestions</h4>
            <div id="poi-suggestions" class="grid grid-cols-1 gap-2"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Drawer -->
  <aside id="clan-drawer" class="drawer hidden" aria-hidden="true">
    <div class="drawer-panel">
      <div class="drawer-header">
        <div class="flex items-center gap-3">
          <img id="drawer-crest" src="" alt="" width="56" height="56" onerror="this.style.display='none'">
          <div>
            <h3 id="drawer-title" class="text-xl font-semibold">Clan</h3>
            <div id="drawer-motto" class="text-xs text-neutral-500"></div>
          </div>
        </div>
        <button id="close-drawer" class="text-neutral-500"><i class="fas fa-times"></i></button>
      </div>
      <div id="drawer-body" class="drawer-body"></div>
    </div>
  </aside>

  <!-- Toast -->
  <div id="message-box" class="hidden"><i id="message-icon" class="mr-2"></i><span id="message-text"></span></div>

  <!-- Simple email handoff modal (Formspree-ready) -->
  <div id="email-modal" class="fixed inset-0 hidden items-center justify-center bg-black/50 p-4">
    <div class="bg-white dark:bg-neutral-900 rounded-2xl max-w-md w-full p-4">
      <div class="flex items-center justify-between mb-2">
        <h3 class="font-semibold">Send itinerary to email</h3>
        <button id="close-email-modal" class="text-stone-600 dark:text-neutral-300"><i class="fas fa-times"></i></button>
      </div>
      <form id="email-form" method="POST" action="https://formspree.io/f/your-endpoint">
        <input type="email" name="email" required placeholder="Your email" class="border rounded p-2 w-full mb-2" />
        <textarea name="itinerary" id="email-itinerary-text" class="border rounded p-2 w-full h-40" readonly></textarea>
        <button class="btn-primary rounded-lg px-4 py-2 mt-2" type="submit">Send</button>
      </form>
      <p class="text-xs text-neutral-500 mt-2">Replace the Formspree endpoint with your own in <code>index.html</code>.</p>
    </div>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
